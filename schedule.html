<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Schedule</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body { font-family: sans-serif; background-color: #f9f9f9; margin: 0; padding: 1rem; }
    #exerciseLibrarySection, #schedulePage { max-width: 600px; margin: 0 auto; background: #fff; padding: 1.5rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h1, h2, h3, h4 { text-align: center; }
    .category-group { margin-bottom: 1rem; }
    .exercise-list label { display: block; margin: 0.25rem 0; }
    #customAdd { display: flex; margin: 1rem 0; }
    #customAdd input { flex: 1; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; }
    #customAdd button { margin-left: 0.5rem; padding: 0.5rem 1rem; background: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    #customAdd button:hover { background: #0056b3; }
    .exercise-config { margin-left: 1rem; margin-bottom: 1rem; padding: 0.5rem 1rem; background-color: #eef2f5; border-radius: 6px; }
    button[type="submit"] { display: block; margin: 1.5rem auto 0; padding: 0.75rem 2rem; font-size: 1rem; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button[type="submit"]:hover { background-color: #0056b3; }
  </style>
</head>
<body>
  <!-- Master Exercise List -->
  <section id="exerciseLibrarySection">
    <h2>Manage Your Exercises</h2>
    <div class="category-group" data-category="bodyweight">
      <h3>Bodyweight</h3>
      <div id="lib-bodyweight" class="exercise-list"></div>
    </div>
    <div class="category-group" data-category="cardio">
      <h3>Cardio</h3>
      <div id="lib-cardio" class="exercise-list"></div>
    </div>
    <div class="category-group" data-category="dumbbell">
      <h3>Dumbbell</h3>
      <div id="lib-dumbbell" class="exercise-list"></div>
    </div>
    <div class="category-group" data-category="kettlebell">
      <h3>Kettlebell</h3>
      <div id="lib-kettlebell" class="exercise-list"></div>
    </div>
    <div class="category-group" data-category="barbell">
      <h3>Barbell</h3>
      <div id="lib-barbell" class="exercise-list"></div>
    </div>
    <div id="customAdd">
      <input type="text" id="newExerciseName" placeholder="Add a custom exercise" />
      <button type="button" onclick="addCustomExercise()">Add</button>
    </div>
  </section>

  <!-- Schedule Form -->
  <section id="schedulePage">
    <h1>Set Workout Schedule</h1>
    <form id="scheduleForm" onchange="toggleDays()">
      <label><input type="radio" name="scheduleType" value="daily" checked /> Daily</label>
      <label><input type="radio" name="scheduleType" value="two-day" /> Two-Day Split</label>

      <div id="day1Options">
        <h3>Day 1</h3>
        <div class="exercise-list" data-day="1"></div>
      </div>
      <div id="day2Options">
        <h3>Day 2</h3>
        <div class="exercise-list" data-day="2"></div>
      </div>

      <button type="submit">Save</button>
    </form>
  </section>

  <script>
    const defaultsByCategory = {
      bodyweight: ["pushups","pullups","squats","toeToBar"],
      cardio: ["running","jumpRope","burpees"],
      dumbbell: ["dumbbellRow","dumbbellPress"],
      kettlebell: ["kettlebellSwing","gobletSquat"],
      barbell: ["barbellSquat","deadlift","benchPress"]
    };

    let masterExercises = JSON.parse(localStorage.getItem("masterExercises") || "[]");
    if (!masterExercises.length) {
      masterExercises = [...defaultsByCategory.bodyweight];
      localStorage.setItem("masterExercises", JSON.stringify(masterExercises));
    }

    Object.entries(defaultsByCategory).forEach(([cat, list]) => {
      const container = document.getElementById(`lib-${cat}`);
      list.forEach(ex => {
        const checked = masterExercises.includes(ex) ? "checked" : "";
        container.innerHTML += `
          <label>
            <input type="checkbox" name="masterEx" value="${ex}" ${checked} />
            ${capitalize(ex)}
          </label>`;
      });
    });

    function addCustomExercise() {
      const name = document.getElementById("newExerciseName").value.trim();
      if (!name) return;
      const id = name.replace(/\s+/g, "").toLowerCase();
      if (!masterExercises.includes(id)) {
        masterExercises.push(id);
        localStorage.setItem("masterExercises", JSON.stringify(masterExercises));
        const customDiv = document.getElementById("customAdd");
        customDiv.insertAdjacentHTML("beforebegin", `
          <div class="exercise-config">
            <label>
              <input type="checkbox" name="masterEx" value="${id}" checked />
              ${capitalize(id)}
            </label>
          </div>`);
      }
      document.getElementById("newExerciseName").value = "";
    }

    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1).replace(/([A-Z])/g, ' $1');
    }

    function buildScheduleLists() {
      document.querySelectorAll(".exercise-list[data-day]").forEach(div => {
        div.innerHTML = "";
        const day = div.dataset.day;
        masterExercises.forEach(ex => {
          div.innerHTML += `
            <label>
              <input type="checkbox" name="day${day}" value="${ex}" />
              ${capitalize(ex)}
            </label>`;
        });
      });
    }

    buildScheduleLists();

    function toggleDays() {
      const scheduleType = document.querySelector('input[name="scheduleType"]:checked').value;
      document.getElementById('day2Options').style.display = (scheduleType === 'two-day') ? 'block' : 'none';
    }

    toggleDays();

    document.getElementById("scheduleForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const boxes = [...this.querySelectorAll("input[name=masterEx]")];
      masterExercises = boxes.filter(b => b.checked).map(b => b.value);
      localStorage.setItem("masterExercises", JSON.stringify(masterExercises));

      const form = new FormData(this);
      const scheduleType = form.get("scheduleType");
      const schedule = { type: scheduleType, day1: [], day2: [], config: {} };
      masterExercises.forEach(ex => {
        [1,2].forEach(day => {
          if (form.getAll(`day${day}`).includes(ex)) {
            schedule[`day${day}`].push(ex);
          }
        });
      });
      localStorage.setItem("workoutSchedule", JSON.stringify(schedule));
      alert("Schedule and exercises saved!");
      window.location.href = "index.html";
    });
  </script>
</body>
</html>
